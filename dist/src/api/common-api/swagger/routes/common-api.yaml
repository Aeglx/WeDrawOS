openapi: 3.0.0
info:
  title: WeDraw公共API
  description: 平台共享的公共API接口
  version: 1.0.0
  contact:
    name: WeDraw技术团队
    email: support@wedraw.com

paths:
  /api/common/health:
    get:
      tags:
        - 系统
      summary: 健康检查
      description: 检查API服务是否正常运行
      responses:
        '200':
          description: 服务正常
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  timestamp:
                    type: string
                    format: date-time
                  version:
                    type: string
  
  /api/common/upload/image:
    post:
      tags:
        - 文件上传
      summary: 上传图片
      description: 上传图片文件到服务器
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: 要上传的图片文件
                type:
                  type: string
                  description: 文件类型（product/avatar/banner等）
                  default: product
      responses:
        '200':
          description: 上传成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    description: 图片访问URL
                  filename:
                    type: string
                    description: 文件名
                  size:
                    type: integer
                    description: 文件大小（字节）
                  width:
                    type: integer
                    description: 图片宽度
                  height:
                    type: integer
                    description: 图片高度

  /api/common/upload/file:
    post:
      tags:
        - 文件上传
      summary: 上传普通文件
      description: 上传非图片文件到服务器
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: 要上传的文件
                type:
                  type: string
                  description: 文件类型（document/certificate等）
                  default: document
      responses:
        '200':
          description: 上传成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    description: 文件访问URL
                  filename:
                    type: string
                    description: 文件名
                  size:
                    type: integer
                    description: 文件大小（字节）

  /api/common/categories:
    get:
      tags:
        - 公共数据
      summary: 获取商品分类列表
      description: 获取所有可用的商品分类
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: 分类ID
                    name:
                      type: string
                      description: 分类名称
                    parentId:
                      type: integer
                      description: 父分类ID，顶级分类为0
                    level:
                      type: integer
                      description: 分类级别
                    icon:
                      type: string
                      description: 分类图标
                    sort:
                      type: integer
                      description: 排序值
                    children:
                      type: array
                      items:
                        $ref: '#/components/schemas/Category'

  /api/common/regions:
    get:
      tags:
        - 公共数据
      summary: 获取地区列表
      description: 获取省市区地区信息
      parameters:
        - name: parentId
          in: query
          description: 父地区ID，查询省份时不传或为0
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: 地区ID
                    name:
                      type: string
                      description: 地区名称
                    parentId:
                      type: integer
                      description: 父地区ID
                    level:
                      type: integer
                      description: 地区级别（1=省，2=市，3=区/县）

  /api/common/search/suggestions:
    get:
      tags:
        - 搜索
      summary: 获取搜索建议
      description: 根据关键词获取搜索建议
      parameters:
        - name: keyword
          in: query
          required: true
          description: 搜索关键词
          schema:
            type: string
        - name: type
          in: query
          description: 搜索类型（product/shop）
          default: product
          schema:
            type: string
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string

  /api/common/messages/send:
    post:
      tags:
        - 消息
      summary: 发送消息
      description: 发送系统消息或通知
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                  description: 接收用户ID
                type:
                  type: string
                  description: 消息类型（system/order/marketing）
                title:
                  type: string
                  description: 消息标题
                content:
                  type: string
                  description: 消息内容
                data:
                  type: object
                  description: 附加数据
      responses:
        '200':
          description: 发送成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: 是否发送成功

components:
  schemas:
    Category:
      type: object
      properties:
        id:
          type: integer
          description: 分类ID
        name:
          type: string
          description: 分类名称
        parentId:
          type: integer
          description: 父分类ID
        level:
          type: integer
          description: 分类级别
        icon:
          type: string
          description: 分类图标
        sort:
          type: integer
          description: 排序值
        children:
          type: array
          items:
            $ref: '#/components/schemas/Category'

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT认证令牌